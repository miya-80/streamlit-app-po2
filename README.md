# streamlit-app-po2

# Amazon商品検索自動入力ツール

---

## 概要

このWebアプリは、Excelファイルに記載された分野別の商品カテゴリー情報を読み込み、  
選択した商品カテゴリー名でAmazonの検索結果ページを自動で開き、検索バーに選択した商品カテゴリーを自動入力するツールです。  

PythonのStreamlitを用いて開発されており、初心者でも操作しやすいシンプルなUIを備えています。

---

## 主な機能

- Excelファイル（サンプルあり）から分野別カテゴリーと商品カテゴリーを読み込む
- 画面にプルダウンで分野別カテゴリー、商品カテゴリーを表示し選択可能
- 「Amazonへ転送」ボタンで選択した商品カテゴリーをAmazonの検索バーに自動入力し、検索結果ページを開く
- Excelの内容を画面上で確認できる機能
- セッションのリセット（再起動）機能

---

## 開発環境・使用ライブラリ

- Python 3.x  
- Streamlit  
- pandas  
- openpyxl  
- urllib  
- webbrowser  

---

## ファイル構成

- `main.py`  
  メインのStreamlitアプリケーションのコード。UI表示と処理のフローを管理。  
- `constants.py`  
  定数や設定値を管理。Excelファイルのパスや画面表示文言などをまとめています。  
- `unit.py`  
  画面表示に関する初期化処理やセッション再起動処理をまとめたユーティリティ関数。  
- `test_file.xlsx`  
  サンプルのExcelファイル。分野別カテゴリーと商品カテゴリーが記載されています。

---

## 使い方

1. アプリを起動します。  
2. 「サンプルExcelを使用する」にチェックを入れます。  
3. 「スタート」ボタンを押してExcelの内容を読み込みます。  
4. 分野別カテゴリーのプルダウンからカテゴリを選択します。  
5. 商品カテゴリーのプルダウンから商品を選択します。  
6. 「Amazonへ転送」ボタンを押すと、Amazonの検索結果ページがブラウザで開き、選択した商品名が検索欄に入力されます。  
7. 必要に応じて「Excel表示」ボタンでExcelの内容を画面に表示できます。  
8. 「セッション再起動」ボタンでアプリの状態をリセット可能です。

---

## コードのポイント

- Excelの読み込みは`openpyxl`で行い、1列目のセルの先頭文字で「分野カテゴリー」か「商品カテゴリー」かを判定し、辞書で管理しています。  
- Streamlitの`st.session_state`を使って、読み込んだデータの状態管理をしています。  
- URLエンコードに`urllib.parse.quote`を使い、Amazonの検索URLを生成。  
- `webbrowser.open()`でブラウザを自動起動し、Amazon検索ページを開きます。  

---

## 注意事項

- 本アプリはサンプルExcelファイルでのみ動作確認を行っています。  
- Excelファイルを差し替えた場合は、フォーマット（1列目に「■」で分野、先頭「・」で商品カテゴリー）が合っている必要があります。  
- 実際の業務利用前に動作確認とエラーハンドリングの追加を推奨します。

---

## 公開URL

以下のURLから実際のWebアプリにアクセスして動作を確認できます。  

[https://app-app-po2.streamlit.app/](https://app-app-po2.streamlit.app/)

---

## 開発者

非ITエンジニアでWebアプリ開発を勉強中のna-80が作成しました。  
同じように学びたい初心者の方に参考になれば嬉しいです。

---

## ライセンス

このリポジトリのコードは個人学習用に作成されたものです。  
商用利用の際は自己責任でお願いいたします。
